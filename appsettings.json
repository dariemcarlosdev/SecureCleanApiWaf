{
  // ===========================================================================================
  // APPLICATION CONFIGURATION - SecureCleanApiWaf
  // ===========================================================================================
  // This file contains base configuration settings for all environments.
  // Settings can be overridden in environment-specific files:
  // - appsettings.Development.json (local development)
  // - appsettings.Production.json (production deployment)
  // 
  // üîê SECURITY WARNING:
  // - NEVER commit sensitive data (passwords, API keys, connection strings) to source control
  // - Use environment variables or Azure Key Vault for production secrets
  // - Rotate secrets regularly
  // ===========================================================================================

  // ===== Azure Configuration =====
  // Azure Key Vault integration for secure secret management
  // Key Vault provides:
  // - Centralized secret storage
  // - Access control and auditing
  // - Automatic secret rotation
  // - Hardware Security Module (HSM) backed encryption
  "Azure": {
    // Key Vault URI - Replace with your actual Key Vault URL
    // Format: https://{vault-name}.vault.azure.net/
    // To create Key Vault: az keyvault create --name {vault-name} --resource-group {rg-name}
    "KeyVaultUri": "https://your-keyvault-name.vault.azure.net/"
  },

  // ===== Logging Configuration =====
  // Controls verbosity of application logging
  // Log Levels (from most to least verbose):
  // - Trace: Very detailed logs (use sparingly, performance impact)
  // - Debug: Detailed debugging information
  // - Information: General informational messages
  // - Warning: Warnings and non-critical issues
  // - Error: Errors and exceptions
  // - Critical: Critical failures requiring immediate attention
  // - None: Disable logging
  "Logging": {
    "LogLevel": {
      // Default log level for all categories not explicitly configured
      "Default": "Information",
      
      // ASP.NET Core framework logs (HTTP requests, routing, etc.)
      // Set to Warning to reduce noise in logs
      "Microsoft.AspNetCore": "Warning",
      
      // General Microsoft framework logs
      "Microsoft": "Warning",
      
      // Application startup and shutdown messages
      "Microsoft.Hosting.Lifetime": "Information",
      
      // Your application logs (SecureCleanApiWaf namespace)
      // Set to Information or Debug for detailed application logging
      "SecureCleanApiWaf": "Information"
    }
  },

  // ===== Allowed Hosts Configuration =====
  // Host filtering middleware configuration
  // "*" allows all hosts (use for development/testing)
  // Production: Specify exact domains to prevent host header attacks
  // Example: "AllowedHosts": "yourdomain.com;www.yourdomain.com"
  "AllowedHosts": "*",

  // ===========================================================================================
  // DATABASE CONFIGURATION
  // ===========================================================================================
  // Entity Framework Core database settings
  // 
  // üîê PRODUCTION SECURITY:
  // - Store connection strings in Azure Key Vault
  // - Use Managed Identity instead of SQL authentication
  // - Enable encryption at rest and in transit
  // - Regular security audits and updates
  "DatabaseSettings": {
    // Connection String: Database connection configuration
    // Development: SQL Server LocalDB (built into Visual Studio)
    // Production: Override with Azure SQL Database connection string from Key Vault
    // 
    // Connection String Formats:
    // LocalDB: "Server=(localdb)\\mssqllocaldb;Database=BlueTreadApp;Trusted_Connection=True;TrustServerCertificate=True;"
    // SQL Express: "Server=localhost\\SQLEXPRESS;Database=BlueTreadApp;Trusted_Connection=True;TrustServerCertificate=True;"
    // Azure SQL: "Server=tcp:yourserver.database.windows.net,1433;Database=BlueTreadApp;User ID=yourusername;Password=yourpassword;Encrypt=True;"
    "ConnectionString": "Server=(localdb)\\mssqllocaldb;Database=SecureCleanApiWaf;Trusted_Connection=True;TrustServerCertificate=True;MultipleActiveResultSets=True",
    
    // Enable Sensitive Data Logging: Log parameter values in SQL queries
    // Development: true (helpful for debugging)
    // Production: MUST be false (security risk - can expose passwords, PII in logs)
    "EnableSensitiveDataLogging": false,
    
    // Enable Detailed Errors: Include detailed error information in exceptions
    // Development: true (easier debugging)
    // Production: false (avoid exposing internal details)
    "EnableDetailedErrors": false,
    
    // Command Timeout: Maximum seconds to wait for database command
    // 30 seconds is reasonable default
    // Adjust based on workload (complex queries may need more time)
    "CommandTimeout": 30,
    
    // Max Retry Count: Number of retry attempts for transient failures
    // 3 retries is standard for Azure SQL Database
    // Handles temporary network issues, failovers, throttling
    "MaxRetryCount": 3,
    
    // Max Retry Delay: Maximum seconds between retry attempts
    // 30 seconds caps exponential backoff delay
    "MaxRetryDelay": 30,
    
    // Enable Query Splitting: Split complex queries with collections
    // false: Single query with JOINs (default)
    // true: Multiple queries (better for large result sets)
    "EnableQuerySplitting": false
  },

  // ===========================================================================================
  // JWT AUTHENTICATION CONFIGURATION
  // ===========================================================================================
  // JSON Web Token (JWT) settings for API authentication
  // JWT provides stateless authentication - server doesn't store session data
  // 
  // üîê PRODUCTION SECURITY REQUIREMENTS:
  // - Store SecretKey in Azure Key Vault (NOT in appsettings.json)
  // - Use strong secret key (minimum 32 characters, use secure random generator)
  // - Reduce token expiration to 15-30 minutes in production
  // - Implement refresh tokens for extended sessions
  // - Use HTTPS only (never send tokens over HTTP)
  // - Rotate keys regularly
  "JwtSettings": {
    // Secret Key: Used to sign and verify JWT tokens (HMAC-SHA256)
    // üö® CRITICAL: This is a DEMO key - NEVER use in production!
    // Generate secure key: openssl rand -base64 32
    // Production: Store in Azure Key Vault and reference via environment variable
    "SecretKey": "YourSuperSecretKeyForJWT_MustBeAtLeast32CharactersLong!",
    
    // Issuer: Identifies who created the token (your application)
    // Used for token validation - ensures token came from trusted source
    // Should match your application name or domain
    "Issuer": "SecureCleanApiWaf",
    
    // Audience: Identifies who the token is intended for (your API)
    // Used for token validation - ensures token is for the right API
    // Can be your API URL or identifier
    "Audience": "SecureCleanApiWaf.Api",
    
    // Token expiration time in minutes
    // 60 minutes = 1 hour (development setting)
    // Production recommendation: 15-30 minutes for better security
    // Shorter expiration = reduced risk if token is compromised
    "ExpirationMinutes": 20,
    
    // Refresh token expiration in days (for future implementation)
    // Refresh tokens allow getting new access tokens without re-authentication
    // Longer lifetime than access tokens (7-30 days typical)
    "RefreshTokenExpirationDays": 1
  },

  // ===========================================================================================
  // EXTERNAL API CONFIGURATION
  // ===========================================================================================
  // Settings for third-party API integration
  // This configuration is used by ApiIntegrationService and ApiKeyHandler
  "ThirdPartyApi": {
    // Base URL: Root address of the external API
    // All API calls will be relative to this base
    // Example: GET /users ‚Üí https://jsonplaceholder.typicode.com/users
    // 
    // Current: JSONPlaceholder (free fake API for testing)
    // Production: Replace with your actual third-party API URL
    "BaseUrl": "https://jsonplaceholder.typicode.com/",
    
    // API Key: Authentication credential for the external API
    // üö® SECURITY: This placeholder must be replaced!
    // 
    // ${VARIABLE_NAME} syntax indicates environment variable substitution
    // In production:
    // 1. Store actual API key in Azure Key Vault
    // 2. Reference via environment variable
    // 3. Never commit real keys to source control
    // 
    // Example Azure Key Vault integration:
    // az keyvault secret set --vault-name {vault} --name "ThirdPartyApiKey" --value "{actual-key}"
    "ApiKey": "${THIRDPARTY_API_KEY}",
    
    // Request timeout in seconds
    // 30 seconds: Reasonable default for most APIs
    // Prevents hanging requests from blocking application
    // Adjust based on API response times:
    // - Fast APIs: 10-15 seconds
    // - Slow/complex queries: 45-60 seconds
    // - File uploads/downloads: 120+ seconds
    "Timeout": 30
  },

  // ===========================================================================================
  // CORS (CROSS-ORIGIN RESOURCE SHARING) CONFIGURATION
  // ===========================================================================================
  // Controls which web domains can access your API
  // CORS security prevents unauthorized websites from calling your API
  // 
  // How CORS works:
  // 1. Browser sends preflight request (OPTIONS) to API
  // 2. API responds with allowed origins, methods, headers
  // 3. If origin is allowed, browser permits the actual request
  // 
  // üîí PRODUCTION SECURITY:
  // - Specify exact domains (never use "*" wildcard)
  // - Use HTTPS URLs only
  // - Remove localhost entries
  // - Include all legitimate client domains (web apps, mobile apps)
  "Cors": {
    // List of allowed origins (domains that can call your API)
    // Format: protocol://domain:port
    // 
    // Current: Development settings (localhost URLs)
    // Production example:
    // "AllowedOrigins": [
    //   "https://yourdomain.com",
    //   "https://www.yourdomain.com",
    //   "https://mobile.yourdomain.com"
    // ]
    "AllowedOrigins": [
      "https://localhost:7000",  // Blazor HTTPS port. Default for Blazor dev server
      "https://localhost:5001"   // Alternate HTTPS port. This port is often used by Kestrel
    ]
  },

  // ===========================================================================================
  // RATE LIMITING CONFIGURATION
  // ===========================================================================================
  // IP-based rate limiting to prevent API abuse and DDoS attacks
  // Tracks requests per IP address and enforces limits
  // 
  // Protection against:
  // - Brute force attacks (repeated login attempts)
  // - API abuse (excessive requests)
  // - DDoS attacks (distributed denial of service)
  // - Resource exhaustion
  // 
  // Uses AspNetCoreRateLimit library for implementation
  "IpRateLimiting": {
    // Enable per-endpoint rate limiting (vs. global only)
    // true: Different limits for different endpoints
    // false: Same limits for all endpoints
    "EnableEndpointRateLimiting": true,
    
    // Stack blocked requests (count against limit even if blocked)
    // false (recommended): Don't count blocked requests
    // true: Blocked requests also count (more strict)
    "StackBlockedRequests": false,
    
    // HTTP header containing real client IP (for load balancers/proxies)
    // Common values:
    // - "X-Real-IP" (Nginx)
    // - "X-Forwarded-For" (most proxies)
    // - "CF-Connecting-IP" (Cloudflare)
    "RealIpHeader": "X-Real-IP",
    
    // Optional header for client identification (beyond IP)
    // Useful for mobile apps or trusted clients
    "ClientIdHeader": "X-ClientId",
    
    // HTTP status code returned when rate limit exceeded
    // 429 "Too Many Requests" is the standard response
    "HttpStatusCode": 429,
    
    // Rate limit rules (applied in order)
    // Can define multiple rules for different time periods
    "GeneralRules": [
      {
        // Apply to all endpoints ("*" is wildcard)
        // Can specify individual endpoints: "api/v1/users"
        "Endpoint": "*",
        
        // Time period for the limit
        // Supported formats:
        // - "1s" = 1 second
        // - "1m" = 1 minute
        // - "1h" = 1 hour
        // - "1d" = 1 day
        "Period": "1m",
        
        // Maximum requests allowed in the period
        // 60 requests per minute = 1 request per second average
        // Production: Adjust based on expected legitimate usage
        "Limit": 60
      },
      {
        // Hourly limit (additional protection)
        "Endpoint": "*",
        "Period": "1h",
        
        // 1000 requests per hour
        // Prevents slow, sustained attacks
        // Most legitimate users won't hit this limit
        "Limit": 1000
      }
    ]
  },

  // ===========================================================================================
  // AZURE KEY VAULT CONFIGURATION (PRODUCTION)
  // ===========================================================================================
  // Azure Key Vault URL for production secret management
  // Overridden in production environment
  // 
  // Setup steps:
  // 1. Create Key Vault: az keyvault create --name {vault-name} --resource-group {rg-name}
  // 2. Enable Managed Identity for App Service
  // 3. Grant access: az keyvault set-policy --name {vault-name} --object-id {managed-identity-id} --secret-permissions get list
  // 4. Store secrets: az keyvault secret set --vault-name {vault-name} --name "SecretName" --value "SecretValue"
  // 
  // Secrets to store in Key Vault:
  // - JWT SecretKey
  // - ThirdPartyApi ApiKey
  // - Database connection strings
  // - Storage account keys
  // - Any other sensitive configuration
  "KeyVault": {
    // Replace with your actual Key Vault URL
    // Program.cs will automatically load secrets from Key Vault in production
    "Url": "https://your-keyvault.vault.azure.net/"
  }
}
